/example -> {name:example}

#MAIN PAGE PRODUCTS
/*SELECT products_attributes.id as id,
products.title as title,
categories.title as category,
products_attributes.photo as photo,
products_attributes.price as price
FROM products
inner join products_attributes
on products_attributes.productID = products.id
inner join categories 
on products.categoryID = categories.id
where categories.title = "Одежда"
#WHERE categories.title = "название категории"
GROUP BY products.title
ORDER BY RAND()
LIMIT 4*/

#VIEW_producuts_in_stock
SELECT
  `products_attributes`.`id` AS `id`,
  SUM(`products_in`.`amountIN`) AS `in_stock`
FROM (`products_attributes`
   JOIN `products_in`
     ON (`products_attributes`.`id` = `products_in`.`productAttributeID`))
GROUP BY `products_attributes`.`id`)$$

#IN STOCK
/*select products_in_stock.id,
products_in_stock.in_stock,
ifnull(sum(products_out.amountOUT),0) as sold,
(products_in_stock.in_stock-IFNULL(SUM(products_out.amountOUT),0)) as current_in_stock
from products_in_stock
left join products_out
on products_in_stock.id = products_out.productAttributeID
WHERE products_in_stock.id = "YOUR ID"
group by products_in_stock.id*/


#GET PRODUCTS BY CATEGORY
SELECT products_attributes.id as id,
       c.title                as category,
       p.title                as title,
       c.description,
       color,
       size,
       price,
       photo
FROM products_attributes
         JOIN products p on products_attributes.productID = p.id
         JOIN categories c on p.categoryID = c.id
WHERE price >= ?
  AND price <= ?
  AND (color = ? OR color = ?)
  AND (c.title = ? OR c.title = ?)
  AND (size = ? OR size = ?)
ORDER BY title DESC
LIMIT ?,?